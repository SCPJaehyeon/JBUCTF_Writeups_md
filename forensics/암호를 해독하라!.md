## **문제 이름**

암호를 해독하라!



## 문제 

당신은 암호 해독 전문가입니다.

주어진 파일은 어떤 암호를 입력해도 절대 풀 수 없습니다.

당신이라면 모든 암호를 풀 수 있을 것이라고 믿습니다.

한 가지 힌트를 드리면 HxD를 사용하여 암호화 영역을 찾아 암호를 해제할 수 있습니다.



## 문제 취지

zip(압축 파일)의 포맷과 Base 64에 대해 학습하는 문제이다.

zip 파일 형식은 데이터를 압축하고 보관하기 위한 파일 형식이다.

하나 혹은 여러 개의 파일들을 크기를 줄여 압축하고 하나로 묶어서 저장한다.

zip 파일의 로컬 헤더 구조를 보면 암호화 영역이 존재한다.

출제자는 zip 파일에 암호화를 하지 않았지만, 암호화를 생성하여 문제에 접하는 사람들은 zip 헤더 구조에서 암호화 영역을 찾아 암호를 해결하는 문제를 의도로 하여 문제를 출제하였다.

암호화가 없는 zip 파일과 이 문제 파일과 헤더 구조를 비교해보면 쉽게 풀 수 있는 문제이다.

암호 문제를 해결하면 플래그는 Base 64 형식으로 되어 있으며, Base 64 문자열을 디코딩 해주는 사이트에서 쉽게 변환 가능하다.



## 풀이 방법

주어진 압축 파일은 어떤 암호를 입력해도 절대로 풀리지 않는 파일이다.

그리고 지문에 HxD 프로그램을 사용하여 암호를 해제할 수 있다고 하였다.

![image](https://user-images.githubusercontent.com/40850499/68205553-f4365e00-000d-11ea-8b6a-0bbf5c13b299.png)

HxD로 압축 파일을 열어 보면 ZIP 파일의 헤더 시그니처를 볼 수 있다.

하지만 시그니처는 각 파일마다 가지는 고유 값이므로 건드려서는 안 된다.

지문에서 HxD로 암호를 해제할 수 있다고 하였으니 ZIP 파일의 포맷을 구글을 통해 검색해보자.

![image](https://user-images.githubusercontent.com/40850499/68205559-f698b800-000d-11ea-95a1-49e35d7fd080.png)

구글을 통해 검색해보면 ZIP 파일의 많은 헤더 구조를 볼 수 있고, 그 중에서 암호화 영역에 대해 알 수 있다.

바로 Bit Flag 부분이다.

암호가 걸려 있지 않은 zip 파일들은 모두 00 00 으로 되어 있을 것이다.

하지만 00 00을 다른 숫자로 변경하면 암호화가 걸려 열리지 않게 된다.

따라서 09 00 부분을 00 00 으로 바꾸면 zip 파일이 열리게 된다.

![image](https://user-images.githubusercontent.com/40850499/68205561-f8fb1200-000d-11ea-950e-df64e5572c6c.png)

![image](https://user-images.githubusercontent.com/40850499/68205950-df0dff00-000e-11ea-869e-d54d8f75f485.png)


앞에만 수정하는 것이 아닌, 뒤에도 ZIP 파일의 영역이 존재하므로 똑같이 09를 00으로 바꿔야 한다.

가이드에 나와 있는대로 파일(F) - 다른 이름으로 저장을 한다. (그냥 저장으로 해도 ZIP 파일은 열린다.)

![iamge](https://user-images.githubusercontent.com/40850499/68205576-fdbfc600-000d-11ea-966d-158e8055b8da.png)

ZIP 파일이 성공적으로 열리게 된다.

안에는 flag.txt 파일이 들어 있는데 확인하면 다음과 같은 문자열들을 볼 수 있다.

![image](https://user-images.githubusercontent.com/40850499/68205584-01534d00-000e-11ea-9a14-539a8fb90324.png)

플래그를 보면 이상한 문자열들이 조합해 있는 것을 볼 수 있다.

아마 =이 들어가 있는 것을 보면 예상하겠지만, Base 64라는 것을 눈치챘을 것이다.

Base 64는 a-z, A-Z, 0-9, +, / 문자열들로 나타낸다. (끝에는 = 문자열 사용)

Base 64 디코딩 사이트에 가서 문자열을 디코딩하면 플래그를 얻을 수 있다.



## Flag

scpCTF{Y0u_Ar3_CrYp70_Ma$73r}



## 힌트

문제 파일과 암호화 되지 않은 파일을 비교해보면 쉽게 해결할 수 있습니다!

zip 파일 헤더 구조를 살펴보시면 암호화 영역이 존재하는데 그 영역을 암호화 되지 않은 파일과 똑같이 변경해주시면 됩니다. 

만약 풀리고 해결이 안 된다면 64개의 기호와 문자를 쓰는 인코딩 방식을 찾아보세요!
