## **문제 이름**

Ransomware



## 문제 

SCP 동아리 사람 중, 누군가가 유튜브 광고때문에 화가 나 JB 광고 회사 컴퓨터를 랜섬웨어에 감염시켰다.

컴퓨터에 저장 된 사진과 여러 파일들은 아무 문제가 없었지만, 중요한 영상은 암호화를 하여 열어볼 수 없게 되었다.

동영상을 하나씩 분석하면서 랜섬웨어에 걸린 파일들을 모두 복구시켜주자.

 



## 문제 취지

이번 문제는 멀티미디어 포렌식 중에서 동영상 분석에 관한 문제이다.

동영상을 분석하여 멀티미디어 데이터에서 증거를 획득하고 분석할 수 있다.

또한 포렌식 관점에서 볼 때, 동영상들이 증거물로 쓰이고 있는 CCTV나 블랙박스 등의 영상을 분석하는 실제 사례를 변형하여 출제자는 실제 포렌식 전문가가 하는 일인 동영상 분석에 대한 증거장면 확보를 위한 문제로 만들게 되었다.

동영상은 다음과 같은 특징을 갖는다.

1. 사진을 연속적으로 보여주는 것
2. 한 장, 한 장의 사진들이 초당 어느속도로 빠르게 바뀌면서 움직이는 하나의 동영상을 만든다.
3. 동영상의 한 장, 한 장의 사진을 프레임이라고 한다.

증거 영상은 1초 그리고 0.1초라도 놓치지 않고 증거를 확보하는 것이 매우 중요하다.

따라서 이 문제를 통해 동영상 프레임에 대한 정확한 분석과 빠른 순간에 움직이는 프레임을 증거로 확보하는 능력을 학습한다.



## 풀이 방법

문제 파일인 zip파일을 확인해보면 여러 개의 zip 파일들이 존재한다.

문제를 풀어나가는 방법은 problem이라고 적혀 있는 zip 파일들이 총 5개 존재한다.

그리고 zip 파일 안에는 각각 다른 동영상들이 들어 있다.

problem 1번 문제를 풀어 암호키를 얻게 되면, 다음 problem 2번 zip 파일의 암호를 풀어 2번 문제를 푸는 방식으로 진행한다.

그리고 5개의 영상 분석을 완료하면 flag가 들어있는 텍스트 파일 zip 파일의 암호키를 얻을 수 있다.



1.problem 1 
![image](https://user-images.githubusercontent.com/40850499/67264377-e220cf80-f4e5-11e9-9d3e-fcabd7def1ca.png)




problem 1번 영상을 보면, 도중에 위 화면이 나오면서 0.2초 만에 빠르게 없어지는 장면을 확인할 수 있다. 

1번 플래그 값은 scpCTF{1e7'5_9o_CTF!!}이다.



2.problem 2 

![image](https://user-images.githubusercontent.com/40850499/67264382-e64ced00-f4e5-11e9-86b4-bdb091c1aa2d.png)

problem 2번 영상은 1번과는 달리, 1번은 플래그 값이 크게 나오면서 마치 이미지가 깜빡이는 것처럼 보인다고 하면, 2번은 영상 안에 텍스트(자막)를 넣어두었다. 

2번 영상도 1번과 같이 0.2초만에 매우 빠르게 프레임이 바뀌게 된다.

2번 플래그 값은 scpCTF{$@m9aNg_bBaBb1C0}



3.problem 3

![image](https://user-images.githubusercontent.com/40850499/67264392-ec42ce00-f4e5-11e9-9b5b-e68d5b0bb237.png)

1,2번 문제들보다는 조금 헷갈릴 정도로 플래그가 나온다.

자세히 보지 않으면 플래그를 지나칠 수도 있을 정도지만, 그래도 캡처하여 쉽게 입력 가능하다.

3번 플래그 값은 scpCTF{0ron@M1nC!}



4.problem4

![image](https://user-images.githubusercontent.com/40850499/67264395-f06eeb80-f4e5-11e9-8d82-747a50355790.png)

3번 문제와 비슷한 문제지만, 3번을 풀었으면 4번도 자세히 보기만 하면 풀 수 있는 문제이다.

4번 플래그 값은  scpCTF{Y@_N01_J@!1!}



5.problem5

![image](https://user-images.githubusercontent.com/40850499/67264398-f2d14580-f4e5-11e9-83ef-aab9832759da.png)

지금까지 나온 문제들과는 다르다.

1~4번 문제들은 플래그 값이 완성된 형태로 나왔지만, 마지막 문제는 글자들이 분리되어 흩어져 있는 상황으로 플래그 값이 나오고, 빨리 프레임이 바뀌기 때문에 조합하는데 시간이 걸릴 수도 있다.

그렇지만 순서대로 나열하여 정리하면 플래그 값을 얻을 수 있다.

5번 플래그 값은 scpCTF{SuNeung_song!}

나온 영상들은 전부 수능 금지곡과 관련된 광고들이었다.

영상을 광고로 정한 이유는 문제를 접하는 사람들이 좀 더 빠르게 풀 수 있고, 쉽게 접근할 수 있도록 하기 위해 광고 영상으로 정했다.

5번 플래그 값은 flag.zip의 암호키로 사용된다.

![image](https://user-images.githubusercontent.com/40850499/67264402-f5cc3600-f4e5-11e9-820f-aa51d2a0e937.png)



flag.zip 파일을 열어 텍스트 파일을 확인해보면 플래그 값이 나오고, 문제가 해결 된다.



 

## Flag

scpCTF{Y0u_Ar3_4r3n$3r!!}



## 힌트

자아 찍습니다! 하나~! 둘~! 셋~! CAPTURE 







