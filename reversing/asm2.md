# asm2 - ??pt

## 문제

바이너리를 objdump 명령어를 이용하여 알아보았더니 다음과 같은 어셈블리 코드를 얻을 수 있었습니다!! asm2(0xDEADbeef,0x8badF00D,0xD00Df4c3) 은 무엇을 반환하나요? 플래그를 제출형식에 맞게 16진수 형식으로 제출하세요!!('0x'로 시작하는 문자열로 제출!)



## 문제 취지

3학년 수업으로도 있는 리버스 엔지니어링을 이용하여 문제를 내보았다. 학교에서 배운 지식을 이용해 풀 수 있고, 실제로 소스 코드가 주어지지 않은 상황에서는 어셈블리를 읽어 하므로 그 능력을 키울 수 있게 하기 위하여 출제.

상세 : 

리틀엔디안 형식을 알고있는가?

쉬프트 레지스터가 메모리를 벗어나면 어떻게 되는가?



## 풀이 방법

```assembly
asm2:
	<+0>:	push   ebp
	<+1>:	mov    ebp,esp
	<+3>:	xor    eax,eax
	<+5>:	mov    ah,BYTE PTR [ebp+0xa]
	<+8>:	shl    ax,0x10
	<+12>:	sub    al,BYTE PTR [ebp+0xf]
	<+15>:	add    ah,BYTE PTR [ebp+0xe]
	<+18>:	xor    ax,WORD PTR [ebp+0x10]
	<+22>:	nop
	<+23>:	pop    ebp
	<+24>:	ret    
```

위 코드가 수행됨에 따른 eax 레지스터의 변화는 다음과 같다.

```
               	    eax
                     		  ax
                         ah       al
   -------------------------------------
   |   00   |   00   |   AD   |   00   |	<< break in +8
   -------------------------------------

   -------------------------------------
   |   00   |   00   |   00   |   75   | 	<< break in +15
   -------------------------------------

   -------------------------------------
   |   00   |   00   |   ad   |   75   |	<< break in +18
   -------------------------------------

   -------------------------------------
   |   00   |   00   |   59   |   b6   |	<< after xor
   -------------------------------------
```

스택은 다음과 같다.

```
<stack>

DWORD grouping

   -----------------   <<< ebp
   |      SFP      |
   -----------------
   |      RET      |
   -----------------   <<< ebp + 8
   |   0xDEADbeef  |
   -----------------   <<< ebp + c
   |   0x8badF00D  |
   -----------------   <<< ebp + 0x10
   |   0xD00Df4c3  |
   -----------------


Byte grouping:

+0x8 +0x9 +0xA +0xB +0xC +0xD +0xE +0xF +0x10 0x11 0x12 0x13
+----+----+----+----+----+----+----+----+----+----+----+----+
| ef | be | AD | DE | 0D | F0 | ad | 8b | c3 | f4 | 0D | D0 |
+----+----+----+----+----+----+----+----+----+----+----+----+

Word grouping:
+0x8   +0xA   +0xC   +0xE   +0x10  +0x12
+------+------+------+------+------+------+
| beef | DEAD | F00D | 8bad | f4c3 | D00D |
+------+------+------+------+------+------+
```





## Flag

scpCTF{0x59b6}



## 힌트

assembly 명령어에 대해 조사해 보세요!

CPU 레지스터의 종류와 용도에 대해 알아보세요!

열 꼬마 [엔디언](<https://ko.wikipedia.org/wiki/%EC%97%94%EB%94%94%EC%96%B8>)들에 대해 알아보아요!